[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "nbdev-proteomics",
    "section": "",
    "text": "A collection of utilities to process proteomics data",
    "crumbs": [
      "nbdev-proteomics"
    ]
  },
  {
    "objectID": "index.html#install",
    "href": "index.html#install",
    "title": "nbdev-proteomics",
    "section": "Install",
    "text": "Install\npip install nbdev_proteomics",
    "crumbs": [
      "nbdev-proteomics"
    ]
  },
  {
    "objectID": "index.html#how-to-use",
    "href": "index.html#how-to-use",
    "title": "nbdev-proteomics",
    "section": "How to use",
    "text": "How to use\nLet’s start by uploading a dataset from a DIA-NN analysis\n\n# Initialize the class with the DIA-NN output file\n# a table to rename the columns and a peptide counts file\nprocessor = DIAnnProcessor(\n    \"../toy_datasets/DIA-NN_output.txt\",\n    \"../toy_datasets/DIA-NN_peptides_counts.txt\",\n    \"../toy_datasets/DIA-NN_column_mapping.csv\",\n)\n\n# Process the file and get the filtered protein quantification DataFrame\nfiltered_quantification = processor.process()\nfiltered_quantification.head()\n\nuse dia-nn\n\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\nMUT4_1.1\nMUT4_1.2\nMUT4_1.3\nWTSOL_2.1\n...\nWTSOL_3.6\nWTINS_3.4\nWTINS_3.5\nWTINS_3.6\nMUT4SOL_3.1\nMUT4SOL_3.2\nMUT4SOL_3.3\nMUT4INS_3.1\nMUT4INS_3.2\nMUT4INS_3.3\n\n\n\n\nGFP.BLA\nNaN\nNaN\nNaN\n9.937347e+06\n1.068154e+07\n9.845878e+06\n9.728128e+06\n1.024333e+07\n9.316970e+06\nNaN\n...\nNaN\nNaN\nNaN\nNaN\n5.944689e+06\n6.888683e+06\n6.956789e+06\nNaN\nNaN\nNaN\n\n\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1\n3.090158e+06\n2.574684e+06\n2.751917e+06\n2.333518e+06\n2.596232e+06\n2.407138e+06\n2.508370e+06\n2.562637e+06\n2.565928e+06\n2.804626e+06\n...\n3.112300e+06\n1.033351e+06\n9.194551e+05\n1.039817e+06\n2.824497e+06\n2.757964e+06\n2.403540e+06\n1.216043e+06\n1.053073e+06\n1.048340e+06\n\n\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1\n3.413114e+07\n3.177892e+07\n3.289960e+07\n2.989977e+07\n3.003979e+07\n3.027149e+07\n3.146555e+07\n3.074012e+07\n3.075175e+07\n3.512207e+07\n...\n3.574694e+07\n1.975402e+06\n1.821761e+06\n1.814954e+06\n3.279010e+07\n3.208254e+07\n3.190298e+07\n1.931748e+06\n1.978563e+06\n1.991076e+06\n\n\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1\n4.962111e+06\n5.049931e+06\n4.865019e+06\n4.767877e+06\n4.826146e+06\n4.738838e+06\n4.982286e+06\n4.989706e+06\n4.672616e+06\n6.168714e+05\n...\n1.333413e+06\n8.680057e+06\n8.580248e+06\n8.776530e+06\n1.135220e+06\n9.074091e+05\n9.992258e+05\n8.560026e+06\n8.473488e+06\n8.810763e+06\n\n\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1\n3.773686e+07\n3.370411e+07\n2.815374e+07\n2.328151e+07\n2.889554e+07\n3.085169e+07\n3.111706e+07\n3.134872e+07\n2.640844e+07\n4.603374e+06\n...\n8.123416e+06\n8.085395e+07\n8.397210e+07\n8.286466e+07\n6.640407e+06\n7.224879e+06\n7.921410e+06\n8.585187e+07\n8.267973e+07\n8.537414e+07\n\n\n\n\n5 rows × 33 columns\n\n\n\n\ncolors = ['r']*filtered_quantification.shape[1]\ncolor_to_label = {'r': 'exp'}\nplot_pca_columns(np.log2(filtered_quantification).dropna(), colors,color_to_label, figsize=(8,8))\n\n\n\n\n\n\n\n\n\ncolors = ['r']*filtered_quantification.shape[1]\ncolor_to_label = {'r': 'exp'}\nplot_mds_columns(np.log2(filtered_quantification).dropna(), colors, color_to_label, figsize=(8,8))",
    "crumbs": [
      "nbdev-proteomics"
    ]
  },
  {
    "objectID": "index.html#exctract-a-subset-of-the-dataframe",
    "href": "index.html#exctract-a-subset-of-the-dataframe",
    "title": "nbdev-proteomics",
    "section": "exctract a subset of the dataframe",
    "text": "exctract a subset of the dataframe\n\ndf = filtered_quantification.iloc[:,:6]\nprint(df.shape)\ndf = df.dropna(how='all',axis=1)\nprint(df.shape)\ndf.head()\n\n(6243, 6)\n(6243, 6)\n\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\n\n\n\n\nGFP.BLA\nNaN\nNaN\nNaN\n9.937347e+06\n1.068154e+07\n9.845878e+06\n\n\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1\n3.090158e+06\n2.574684e+06\n2.751917e+06\n2.333518e+06\n2.596232e+06\n2.407138e+06\n\n\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1\n3.413114e+07\n3.177892e+07\n3.289960e+07\n2.989977e+07\n3.003979e+07\n3.027149e+07\n\n\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1\n4.962111e+06\n5.049931e+06\n4.865019e+06\n4.767877e+06\n4.826146e+06\n4.738838e+06\n\n\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1\n3.773686e+07\n3.370411e+07\n2.815374e+07\n2.328151e+07\n2.889554e+07\n3.085169e+07\n\n\n\n\n\n\n\n\ndf.describe()\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\n\n\n\n\ncount\n6.121000e+03\n6.100000e+03\n6.103000e+03\n6.093000e+03\n6.107000e+03\n6.116000e+03\n\n\nmean\n3.599249e+07\n3.543187e+07\n3.535706e+07\n3.248318e+07\n3.240360e+07\n3.263686e+07\n\n\nstd\n3.026840e+08\n2.929701e+08\n3.003849e+08\n2.607200e+08\n2.501787e+08\n2.565394e+08\n\n\nmin\n3.204720e+04\n6.152255e+04\n3.883329e+04\n6.272731e+04\n9.318066e+04\n8.053832e+04\n\n\n25%\n2.071758e+06\n2.104831e+06\n2.123954e+06\n2.055398e+06\n2.105090e+06\n2.034196e+06\n\n\n50%\n4.921638e+06\n4.928115e+06\n4.907622e+06\n4.794456e+06\n4.868387e+06\n4.816218e+06\n\n\n75%\n1.327099e+07\n1.310617e+07\n1.300904e+07\n1.269331e+07\n1.262831e+07\n1.285196e+07\n\n\nmax\n1.643516e+10\n1.617111e+10\n1.550483e+10\n1.319888e+10\n1.241172e+10\n1.318592e+10\n\n\n\n\n\n\n\n\ndataset_viz = DatasetViz(df = df, palette = ['r']*3+['b']*3)\ndataset_viz.analyse_missing_values(figsize=(8,4))\ndataset_viz.analyse_values_distribution(figsize=(8,4))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndf_norm_load = norm_loading(df)\ndataset_viz = DatasetViz(df = df_norm_load, palette = ['r']*3+['b']*3)\ndataset_viz.analyse_missing_values(figsize=(8,4))\ndataset_viz.analyse_values_distribution(figsize=(8,4))\n\nWT_1.1      4.921638e+06\nWT_1.2      4.928115e+06\nWT_1.3      4.907622e+06\nMUT3_1.1    4.794456e+06\nMUT3_1.2    4.868387e+06\nMUT3_1.3    4.816218e+06\ndtype: float64\n4872739.30693322\nWT_1.1      0.990065\nWT_1.2      0.988763\nWT_1.3      0.992892\nMUT3_1.1    1.016328\nMUT3_1.2    1.000894\nMUT3_1.3    1.011736\ndtype: float64\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndf_norm_load.describe()\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\n\n\n\n\ncount\n6.121000e+03\n6.100000e+03\n6.103000e+03\n6.093000e+03\n6.107000e+03\n6.116000e+03\n\n\nmean\n3.563489e+07\n3.503373e+07\n3.510575e+07\n3.301356e+07\n3.243256e+07\n3.301988e+07\n\n\nstd\n2.996768e+08\n2.896781e+08\n2.982498e+08\n2.649770e+08\n2.504023e+08\n2.595501e+08\n\n\nmin\n3.172880e+04\n6.083124e+04\n3.855726e+04\n6.375152e+04\n9.326396e+04\n8.148349e+04\n\n\n25%\n2.051175e+06\n2.081180e+06\n2.108857e+06\n2.088959e+06\n2.106972e+06\n2.058069e+06\n\n\n50%\n4.872739e+06\n4.872739e+06\n4.872739e+06\n4.872739e+06\n4.872739e+06\n4.872739e+06\n\n\n75%\n1.313913e+07\n1.295890e+07\n1.291657e+07\n1.290056e+07\n1.263960e+07\n1.300279e+07\n\n\nmax\n1.627187e+10\n1.598940e+10\n1.539462e+10\n1.341439e+10\n1.242281e+10\n1.334066e+10\n\n\n\n\n\n\n\n\n\n\n(152, 260)\n\n\n\ndf_norm_load_imputed, detection_limit_imputed_indices, iterative_imputer_imputed_indices = impute_proteomics_data(df_norm_load, ['A','A','A','B','B','B'])\ndataset_viz = DatasetViz(df = df_norm_load_imputed,palette = ['r']*3+['b']*3)\nprint(len(detection_limit_imputed_indices),len(iterative_imputer_imputed_indices))\ndataset_viz.analyse_missing_values(figsize=(8,4))\ndataset_viz.analyse_values_distribution(figsize=(8,4))\n\nfill na with detection_limit: 116342.31145379972 5.065737687979267 Index(['WT_1.1', 'WT_1.2', 'WT_1.3'], dtype='object')\nfill na with detection_limit: 128099.10559899165 5.107546097466946 Index(['MUT3_1.1', 'MUT3_1.2', 'MUT3_1.3'], dtype='object')\n152 260\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndf_norm_load_imputed.describe()\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\n\n\n\n\ncount\n6.243000e+03\n6.243000e+03\n6.243000e+03\n6.243000e+03\n6.243000e+03\n6.243000e+03\n\n\nmean\n3.500385e+07\n3.428577e+07\n3.435545e+07\n3.223566e+07\n3.174944e+07\n3.236610e+07\n\n\nstd\n2.967683e+08\n2.863835e+08\n2.949284e+08\n2.618208e+08\n2.477018e+08\n2.569362e+08\n\n\nmin\n5.828539e+04\n7.446140e+04\n6.129801e+04\n6.644884e+04\n5.337315e+04\n8.427987e+04\n\n\n25%\n1.973416e+06\n1.957926e+06\n1.994725e+06\n1.993400e+06\n2.034857e+06\n1.977900e+06\n\n\n50%\n4.810964e+06\n4.729558e+06\n4.746362e+06\n4.700474e+06\n4.700683e+06\n4.711367e+06\n\n\n75%\n1.285453e+07\n1.278215e+07\n1.271491e+07\n1.244475e+07\n1.227793e+07\n1.252151e+07\n\n\nmax\n1.627187e+10\n1.598940e+10\n1.539462e+10\n1.341439e+10\n1.242281e+10\n1.334066e+10\n\n\n\n\n\n\n\n\nimputed_selection_normed = np.log2(df_norm_load_imputed)\n\n\ncolors = ['r']*3+['b']*3\ncolor_to_label = {'r': 'WT', 'b': 'MUT'}\nplot_mds_columns(imputed_selection_normed, colors, color_to_label)\n\n\n\n\n\n\n\n\n\nplot_pca_columns(imputed_selection_normed, colors, color_to_label)\n\n\n\n\n\n\n\n\n\nimputed_selection_normed.describe()\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\n\n\n\n\ncount\n6243.000000\n6243.000000\n6243.000000\n6243.000000\n6243.000000\n6243.000000\n\n\nmean\n22.403594\n22.382280\n22.377914\n22.359599\n22.385108\n22.371003\n\n\nstd\n2.261674\n2.252626\n2.247010\n2.249750\n2.203008\n2.242486\n\n\nmin\n15.830847\n16.184205\n15.903553\n16.019956\n15.703827\n16.362901\n\n\n25%\n20.912263\n20.900894\n20.927758\n20.926800\n20.956496\n20.915538\n\n\n50%\n22.197895\n22.173274\n22.178391\n22.164375\n22.164439\n22.167714\n\n\n75%\n23.615773\n23.607625\n23.600017\n23.569034\n23.549561\n23.577906\n\n\nmax\n33.921661\n33.896397\n33.841707\n33.643062\n33.532273\n33.635111\n\n\n\n\n\n\n\n\nimputed_selection_normed.head()\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\n\n\n\n\nGFP.BLA\n17.350618\n16.877316\n17.281742\n23.267795\n23.349905\n23.247921\n\n\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1\n21.544844\n21.279661\n21.381715\n21.177441\n21.309277\n21.215720\n\n\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1\n25.010180\n24.905264\n24.961276\n24.856997\n24.841660\n24.868289\n\n\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1\n22.228117\n22.251529\n22.203723\n22.208281\n22.203729\n22.192934\n\n\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1\n25.155066\n24.990118\n24.736532\n24.496047\n24.785633\n24.895679\n\n\n\n\n\n\n\n\nlibrary(\"limma\")\n\nlimma_differential_expression &lt;- function(df, replicates_A, replicates_B) {\n  # Define sample groups\n  sample_groups &lt;- factor(\n    c(rep(\"A\", replicates_A), rep(\"B\", replicates_B)),\n    levels = c(\"A\", \"B\")\n  )\n\n  # Create a design matrix\n  design_matrix &lt;- model.matrix(~0 + sample_groups)\n  colnames(design_matrix) &lt;- c(\"A\", \"B\")\n\n  # Fit a linear model to the data\n  lm_fit &lt;- lmFit(df, design_matrix)\n\n  # Define contrasts (comparisons between groups)\n  contrast_matrix &lt;- makeContrasts(\"B-A\", levels = design_matrix)\n\n  # Fit the contrasts to the linear model\n  contrasted_fit &lt;- contrasts.fit(lm_fit, contrast_matrix)\n\n  # Apply empirical Bayes smoothing\n  ebayes_fit &lt;- eBayes(contrasted_fit)\n\n  # Extract results without sorting and return all rows\n  results &lt;- topTable(ebayes_fit, coef = 1, sort.by = \"none\", number = Inf)\n\n  return(results)\n}\n\n\nresults &lt;- limma_differential_expression(imputed_selection_normed, 3, 3)\nhead(results)\n\n                                                logFC  AveExpr          t\nGFP.BLA                                    6.11864849 20.22922 47.3293349\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1 -0.16792710 21.31811 -2.1050623\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1 -0.10325758 24.90728 -2.3404239\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1 -0.02614141 22.21472 -0.6920798\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1 -0.23478582 24.84318 -1.6221870\nTb05.5K5.150:mRNA-p1;Tb927.5.4500:mRNA-p1 -0.05630553 26.25538 -0.7968936\n                                               P.Value    adj.P.Val         B\nGFP.BLA                                   7.631331e-09 0.0000150629 10.199640\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1 8.067602e-02 0.2250493179 -5.509594\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1 5.850568e-02 0.1864476665 -5.178813\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1 5.151720e-01 0.6812580102 -7.165282\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1 1.567006e-01 0.3291661121 -6.166449\nTb05.5K5.150:mRNA-p1;Tb927.5.4500:mRNA-p1 4.563586e-01 0.6366584845 -7.082207\n\n\n\nresults\n\n\n\n\n\n\n\n\nlogFC\nAveExpr\nt\nP.Value\nadj.P.Val\nB\n\n\n\n\nGFP.BLA\n6.118648\n20.229216\n47.329335\n7.631331e-09\n0.000015\n10.199640\n\n\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1\n-0.167927\n21.318110\n-2.105062\n8.067602e-02\n0.225049\n-5.509594\n\n\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1\n-0.103258\n24.907278\n-2.340424\n5.850568e-02\n0.186448\n-5.178813\n\n\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1\n-0.026141\n22.214719\n-0.692080\n5.151720e-01\n0.681258\n-7.165282\n\n\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1\n-0.234786\n24.843179\n-1.622187\n1.567006e-01\n0.329166\n-6.166449\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\nTb927.9.9870:mRNA-p1\n0.021158\n23.977410\n0.505039\n6.318267e-01\n0.766390\n-7.288104\n\n\nTb927.9.9940:mRNA-p1\n0.110974\n26.507374\n2.625228\n3.991415e-02\n0.154869\n-4.777352\n\n\nTb927.9.9950:mRNA-p1\n0.086074\n19.670132\n0.734206\n4.909454e-01\n0.663127\n-7.133060\n\n\nTb927.9.9960:mRNA-p1\n-0.265460\n21.796494\n-6.330320\n7.743785e-04\n0.022843\n-0.428122\n\n\nTb927.9.9970:mRNA-p1\n-0.037307\n21.473382\n-0.671685\n5.271806e-01\n0.690266\n-7.180301\n\n\n\n\n6243 rows × 6 columns\n\n\n\n\n'Tb927.7.6490:mRNA-p1'\n'Target' 'b'\n\ndetection_limit_imputed_indices, iterative_imputer_imputed_indices\nprotein_names = ['GFP.BLA','Tb427.BES40.22']\nprotein_colors=['b','r']\nprotein_indices = ['GFP.BLA','Tb427.BES40.22',]\n\nfor n in detection_limit_imputed_indices:\n    if n not in protein_indices:\n        protein_indices.append(n)\n        protein_names.append('')\n        protein_colors.append('y')\n\nfor n in iterative_imputer_imputed_indices:\n    if n not in protein_indices:\n        protein_indices.append(n)\n        protein_names.append('')\n        protein_colors.append('c')        \n        \n\nplot_volcano_ma(results, \"comparison WT 113\", \n                protein_indices=protein_indices, \n                protein_names=protein_names, protein_colors=protein_colors)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#filtered_quantification.head()",
    "crumbs": [
      "nbdev-proteomics"
    ]
  },
  {
    "objectID": "dim_red.html",
    "href": "dim_red.html",
    "title": "dim_red",
    "section": "",
    "text": "source\n\nnormalize_dataframe\n\n normalize_dataframe (in_df)\n\n\nsource\n\n\nplot_mds_columns\n\n plot_mds_columns (in_df, colors, color_to_label, figsize=(4, 4),\n                   annotate=True, adjust=True, fig_name=False)\n\n\nsample_data = np.random.rand(50, 4)\nsample_columns = ['A', 'B', 'C', 'D']\nsample_index = range(50)\nsample_df = pd.DataFrame(sample_data, columns=sample_columns, index=sample_index)\ncolors = ['red', 'green', 'blue', 'orange']\ncolor_to_label = {'red': 'Label A', 'green': 'Label B', 'blue': 'Label C', 'orange': 'Label D'}\n\ntmp_df = plot_mds_columns(sample_df, colors, color_to_label)\ntmp_df\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDIM_1\nDIM_2\n\n\n\n\nA\n4.052452\n4.714738\n\n\nB\n-4.310441\n3.444238\n\n\nC\n4.433542\n-3.371731\n\n\nD\n-4.175553\n-4.787246\n\n\n\n\n\n\n\n\nsource\n\n\nplot_pca_columns\n\n plot_pca_columns (in_df, colors, color_to_label, figsize=(4, 4),\n                   annotate=True, adjust=True, fig_name=False)\n\n\nsource\n\n\nintensity_filter\n\n intensity_filter (indf, top=500)\n\nreturn top n rows from df based on mean average of rows\n\nsample_data = np.random.rand(50, 4)\nsample_columns = ['A', 'B', 'C', 'D']\nsample_index = range(50)\nsample_df = pd.DataFrame(sample_data, columns=sample_columns, index=sample_index)\ncolors = ['red', 'green', 'blue', 'orange']\ncolor_to_label = {'red': 'Label A', 'green': 'Label B', 'blue': 'Label C', 'orange': 'Label D'}\ntemp_df = plot_pca_columns(sample_df, colors, color_to_label,figsize=(8,8))\ntemp_df\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDIM_1\nDIM_2\n\n\n\n\nA\n3.138650\n-1.345762\n\n\nB\n-3.323898\n5.193468\n\n\nC\n-4.393920\n-4.358112\n\n\nD\n4.579168\n0.510407\n\n\n\n\n\n\n\n\nsource\n\n\ntop_n_rows_driving_columns\n\n top_n_rows_driving_columns (df, column_1, column_2, component=0, n=5,\n                             direction='togheter')\n\n\nsample_data = np.random.rand(50, 4)\nsample_columns = ['A', 'B', 'C', 'D']\nsample_index = range(50)\nsample_df = pd.DataFrame(sample_data, columns=sample_columns, index=sample_index)\nprint(top_n_rows_driving_columns(sample_df, 'A', 'B', component=0, n=3, direction='apart'))\nprint(top_n_rows_driving_columns(sample_df, 'A', 'B', component=0, n=3, direction='togheter'))\n\n[41, 10, 20]\n[3, 30, 38]\n\n\n\n#filtered_quantification.tail(50)",
    "crumbs": [
      "dim_red"
    ]
  },
  {
    "objectID": "impute_missing.html",
    "href": "impute_missing.html",
    "title": "impute_missing",
    "section": "",
    "text": "source\n\nimpute_proteomics_data\n\n impute_proteomics_data (df, conditions, stdev_size=0.2)\n\n\n# Example usage\ndata = {\n    \"A1\": [1,    2, 3, np.nan, 5,4,4],\n    \"A2\": [2,    3, 4, np.nan, 6,4,np.nan],\n    \"A3\": [1, np.nan, 3, np.nan, 5,np.nan,np.nan],\n    \"B1\": [10, 11, 1, 13, np.nan,20,40],\n    \"B2\": [11, 12, np.nan, 14, np.nan,25,np.nan],\n    \"B3\": [10, 11, 1, 13, np.nan,np.nan, np.nan]\n}\ndf = pd.DataFrame(data)\ndf\n\n\n\n\n\n\n\n\nA1\nA2\nA3\nB1\nB2\nB3\n\n\n\n\n0\n1.0\n2.0\n1.0\n10.0\n11.0\n10.0\n\n\n1\n2.0\n3.0\nNaN\n11.0\n12.0\n11.0\n\n\n2\n3.0\n4.0\n3.0\n1.0\nNaN\n1.0\n\n\n3\nNaN\nNaN\nNaN\n13.0\n14.0\n13.0\n\n\n4\n5.0\n6.0\n5.0\nNaN\nNaN\nNaN\n\n\n5\n4.0\n4.0\nNaN\n20.0\n25.0\nNaN\n\n\n6\n4.0\nNaN\nNaN\n40.0\nNaN\nNaN\n\n\n\n\n\n\n\n\nconditions = [\"A\", \"A\", \"A\", \"B\", \"B\", \"B\"]\nimputed_df = impute_proteomics_data(df, conditions)\nimputed_df\n\ndetection_limit 11.5\ndetection_limit 3.5\n\n\n\n\n\n\n\n\n\nA1\nA2\nA3\nB1\nB2\nB3\n\n\n\n\n0\n3.50000\n3.500000\n3.500000\n11.500000\n11.500000\n11.500000\n\n\n1\n3.50000\n3.500000\n3.500000\n11.500000\n12.000000\n11.500000\n\n\n2\n3.50000\n4.000000\n3.500000\n11.500000\n11.500000\n11.500000\n\n\n3\n2.94932\n4.251355\n2.497197\n13.000000\n14.000000\n13.000000\n\n\n4\n5.00000\n6.000000\n5.000000\n11.356103\n12.932057\n11.023701\n\n\n5\n4.00000\n4.000000\n3.500000\n20.000000\n25.000000\n21.999991\n\n\n6\n4.00000\n4.297517\n3.648759\n40.000000\n52.111114\n45.555528",
    "crumbs": [
      "impute_missing"
    ]
  },
  {
    "objectID": "core.html",
    "href": "core.html",
    "title": "core",
    "section": "",
    "text": "source\n\nplot_volcano_ma\n\n plot_volcano_ma (df, title, protein_indices=None, protein_names=None,\n                  protein_colors=None)\n\n\nsource\n\n\nparse_fasta_file\n\n parse_fasta_file (fasta_file)\n\ncreate a dictionary of protein id to gene product using fasta file from tritrypDB\n\nsource\n\n\nDatasetViz\n\n DatasetViz (df='', palette=False)\n\nClass to visualize a data frame\n\nsource\n\n\nnorm_loading\n\n norm_loading (df)\n\nnormalization loading for the columns of a dataframe the columns shuld be comparable (ie do not mix fractionated samples, for example cytosolic and extracellulars)\n\nsource\n\n\nires_norm\n\n ires_norm (df, exps_columns)\n\nimplement IRES norm for TMT example irs_df = ires_norm(df.replace(0,np.nan).fillna(df.mean()),[tmt10, tmt6]) remember to set nan again after norm irs_df[df.replace(0,np.nan).isna()]=np.nan\n\nsource\n\n\nnorm_loading_TMT\n\n norm_loading_TMT (df)\n\n\nsource\n\n\nDatasetAnalysis\n\n DatasetAnalysis ()\n\nClass to store common functions for the analysis of proteomics data\n\nsource\n\n\nSpectronautProcessor\n\n SpectronautProcessor (file_name='', column_mapping='')\n\nClass to make a Spectronaut output ready for quntification\n\n# Initialize the class with the Spectronaut output file\n# and a table to rename the columns\nprocessor = SpectronautProcessor(\n    \"../toy_datasets/spectronaut_output.tsv\",\n    \"../toy_datasets/spectronaut_column_mapping.tsv\")\n\n# Process the file and get the filtered protein quantification DataFrame\nfiltered_quantification = processor.process()\nfiltered_quantification.head()\n\nuse spec\n\n\n/var/folders/r1/gf3p5gjs5j9gw_49cj98r8b00000gp/T/ipykernel_37232/343760872.py:21: FutureWarning: The default value of regex will change from True to False in a future version.\n  mapping_df['col_name'] = mapping_df['col_name'].str.replace('.IsSingleHit', '.Quantity')\n\n\n\n\n\n\n\n\n\nCELL34.1\nCELL34.2\nCELL34.3\nCELL37.1\nCELL37.2\nCELL37.3\nCELL40.1\nCELL40.2\nCELL40.3\nSN34.1\nSN34.2\nSN34.3\nSN37.1\nSN37.2\nSN37.3\nSN40.1\nSN40.2\nSN40.3\n\n\nPG.ProteinGroups\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1\n100761.148438\n102093.578125\n111970.757812\n9.912009e+04\n9.892971e+04\n104091.296875\n9.230105e+04\n8.521016e+04\n9.303921e+04\n1.059773e+05\n1.758232e+05\n1.723805e+05\n1.177306e+05\n1.194134e+05\n9.913514e+04\n1.292707e+05\n8.649082e+04\nNaN\n\n\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1\n527764.312500\n500388.437500\n550439.875000\n5.322265e+05\n5.465213e+05\n526252.875000\n5.184422e+05\n5.493845e+05\n5.406865e+05\n1.803380e+06\n2.018498e+06\n2.165891e+06\n1.756413e+06\n1.795156e+06\n1.982255e+06\n1.549031e+06\n1.549369e+06\n1.828279e+06\n\n\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1\n944657.187500\n960022.125000\n869661.000000\n1.005103e+06\n1.223561e+06\n260486.875000\n4.613028e+05\n3.256813e+05\n2.587150e+05\nNaN\nNaN\n2.306012e+05\n1.692870e+06\n1.343459e+03\nNaN\nNaN\nNaN\nNaN\n\n\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1\n447414.593750\n458718.562500\n461863.687500\n5.140265e+05\n4.905025e+05\n490315.968750\n5.433065e+05\n5.192081e+05\n5.276954e+05\n3.807705e+04\n7.048350e+04\n1.169908e+05\n7.014255e+04\n8.226525e+04\n8.156412e+04\n1.121125e+05\n1.304798e+05\n9.383632e+04\n\n\nTb05.5K5.150:mRNA-p1;Tb927.5.4500:mRNA-p1\n860323.937500\n824793.812500\n827789.562500\n1.057513e+06\n9.740054e+05\n848213.187500\n1.076790e+06\n1.079964e+06\n1.100252e+06\n3.568418e+06\n2.663594e+05\n4.960689e+05\n1.402994e+06\n9.042108e+05\n5.891444e+05\n1.438731e+06\n2.395180e+05\n1.274326e+06\n\n\n\n\n\n\n\n\nfiltered_quantification.shape\n\n(49, 18)\n\n\n\nsource\n\n\nDIAnnProcessor\n\n DIAnnProcessor (file_name='', peptides_count='', column_mapping='',\n                 min_n_peptide=2)\n\nClass to make a DIA-NN output ready for quntification\n\n# Initialize the class with the Spectronaut output file\n# and a table to rename the columns\nprocessor = DIAnnProcessor(\n    \"../toy_datasets/DIA-NN_output.txt\",\n    \"../toy_datasets/DIA-NN_peptides_counts.txt\",\n    \"../toy_datasets/DIA-NN_column_mapping.csv\",\n)\n# Process the file and get the filtered protein quantification DataFrame\nfiltered_quantification = processor.process()\nfiltered_quantification.head()\n\nuse dia-nn\n\n\n/var/folders/r1/gf3p5gjs5j9gw_49cj98r8b00000gp/T/ipykernel_75592/1785320289.py:21: FutureWarning: The default value of regex will change from True to False in a future version.\n  mapping_df['col_name'] = mapping_df['col_name'].str.replace('.IsSingleHit', '.Quantity')\n\n\n\n\n\n\n\n\n\nWT_1.1\nWT_1.2\nWT_1.3\nMUT3_1.1\nMUT3_1.2\nMUT3_1.3\nMUT4_1.1\nMUT4_1.2\nMUT4_1.3\nWTSOL_2.1\n...\nWTSOL_3.6\nWTINS_3.4\nWTINS_3.5\nWTINS_3.6\nMUT4SOL_3.1\nMUT4SOL_3.2\nMUT4SOL_3.3\nMUT4INS_3.1\nMUT4INS_3.2\nMUT4INS_3.3\n\n\n\n\nGFP.BLA\nNaN\nNaN\nNaN\n9.937347e+06\n1.068154e+07\n9.845878e+06\n9.728128e+06\n1.024333e+07\n9.316970e+06\nNaN\n...\nNaN\nNaN\nNaN\nNaN\n5.944689e+06\n6.888683e+06\n6.956789e+06\nNaN\nNaN\nNaN\n\n\nTb05.5K5.100:mRNA-p1;Tb927.5.4450:mRNA-p1\n3.090158e+06\n2.574684e+06\n2.751917e+06\n2.333518e+06\n2.596232e+06\n2.407138e+06\n2.508370e+06\n2.562637e+06\n2.565928e+06\n2.804626e+06\n...\n3.112300e+06\n1.033351e+06\n9.194551e+05\n1.039817e+06\n2.824497e+06\n2.757964e+06\n2.403540e+06\n1.216043e+06\n1.053073e+06\n1.048340e+06\n\n\nTb05.5K5.110:mRNA-p1;Tb927.5.4460:mRNA-p1\n3.413114e+07\n3.177892e+07\n3.289960e+07\n2.989977e+07\n3.003979e+07\n3.027149e+07\n3.146555e+07\n3.074012e+07\n3.075175e+07\n3.512207e+07\n...\n3.574694e+07\n1.975402e+06\n1.821761e+06\n1.814954e+06\n3.279010e+07\n3.208254e+07\n3.190298e+07\n1.931748e+06\n1.978563e+06\n1.991076e+06\n\n\nTb05.5K5.120:mRNA-p1;Tb927.5.4470:mRNA-p1\n4.962111e+06\n5.049931e+06\n4.865019e+06\n4.767877e+06\n4.826146e+06\n4.738838e+06\n4.982286e+06\n4.989706e+06\n4.672616e+06\n6.168714e+05\n...\n1.333413e+06\n8.680057e+06\n8.580248e+06\n8.776530e+06\n1.135220e+06\n9.074091e+05\n9.992258e+05\n8.560026e+06\n8.473488e+06\n8.810763e+06\n\n\nTb05.5K5.130:mRNA-p1;Tb927.5.4480:mRNA-p1\n3.773686e+07\n3.370411e+07\n2.815374e+07\n2.328151e+07\n2.889554e+07\n3.085169e+07\n3.111706e+07\n3.134872e+07\n2.640844e+07\n4.603374e+06\n...\n8.123416e+06\n8.085395e+07\n8.397210e+07\n8.286466e+07\n6.640407e+06\n7.224879e+06\n7.921410e+06\n8.585187e+07\n8.267973e+07\n8.537414e+07\n\n\n\n\n5 rows × 33 columns\n\n\n\n\n#processor.analyse_missing_values(filtered_quantification,figsize=(16,4))\n\n\ndataset_viz = DatasetViz(df = filtered_quantification)\ndataset_viz.analyse_missing_values(figsize=(16,4))\n\n\n\n\n\n\n\n\n/var/folders/r1/gf3p5gjs5j9gw_49cj98r8b00000gp/T/ipykernel_75592/1333467333.py:33: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  plt.tight_layout()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndataset_viz.analyse_values_distribution(figsize=(16,4))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#filtered_quantification.tail(50)",
    "crumbs": [
      "core"
    ]
  }
]